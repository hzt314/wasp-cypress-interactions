setwd('/Users/han/data/SCU/lab/kuang_project/co_evolution/co_gwas')
h_h <- read.table('output_h/marginal_host.txt')
h_w <- read.table('output_h/marginal_pathogen.txt')
w_h <- read.table('output_p/marginal_host.txt')
w_w <- read.table('output_p/marginal_pathogen.txt')
#i <- read.table('interaction.txt')

hh_0.05 <- h_h[which(h_h[,4] < 0.001),]
hw_0.05 <- h_w[which(h_w[,4] < 0.001),]
wh_0.05 <- w_h[which(w_h[,4] < 0.001),]
ww_0.05 <- w_w[which(w_w[,4] < 0.001),]

ve_h <- unlist(hh_0.05[,2])
int_h <- wh_0.05[wh_0.05[,2] %in% ve_h,]
ve_w <- unlist(hw_0.05[,2])
int_w <- ww_0.05[ww_0.05[,2] %in% ve_w,]

write.csv(int_h, 'cross_h.csv', row.names = F, col.names = F)
write.csv(int_w, 'cross_w.csv', row.names = F, col.names = F)

write.csv(as.numeric(rownames(h_0.001)), '/Volumes/TOSHIBA/output_p/h_0.001.txt', row.names = F, col.names = F)
write.csv(as.numeric(rownames(w_0.001)), '/Volumes/TOSHIBA/output_p/w_0.001.txt', row.names = F, col.names = F)

ph <- read.table('../phenotype_host.txt')
pw <- read.table('../phenotype_pathogen.txt')
ph <- ph[,c(1:4,6,7,9,10,12,14,26)]
pw <- pw[,c(1:4,6,7,9,10,12,14,26)]

ph[1:252,4] <- rnorm(252, 9.241667, 0.01)
ph[253:290,4] <- rnorm(38, 13.7, 0.01)
ph[291:338,4] <- rnorm(48, 6.929166, 0.01)
ph[339:362,4] <- rnorm(24, 13.65, 0.01)
ph[363:368,4] <- rnorm(6, 12.166667, 0.01)
ph[369:374,4] <- rnorm(6, 15.5, 0.01)
pw[1:252,4] <- rnorm(252, 9.241667, 0.01)
pw[253:290,4] <- rnorm(38, 13.7, 0.01)
pw[291:338,4] <- rnorm(48, 6.929166, 0.01)
pw[339:362,4] <- rnorm(24, 13.65, 0.01)
pw[363:368,4] <- rnorm(6, 12.166667, 0.01)
pw[369:374,4] <- rnorm(6, 15.5, 0.01)

ph[1:252,5] <- rnorm(252, 42.11538, 0.01)
ph[253:290,5] <- rnorm(38, 46.99571, 0.01)
ph[291:338,5] <- rnorm(48, 40.94982, 0.01)
ph[339:362,5] <- rnorm(24, 45.30812, 0.01)
ph[363:368,5] <- rnorm(6, 50.2, 0.01)
ph[369:374,5] <- rnorm(6, 43.99039, 0.01)
pw[1:252,5] <- rnorm(252, 42.11538, 0.01)
pw[253:290,5] <- rnorm(38, 46.99571, 0.01)
pw[291:338,5] <- rnorm(48, 40.94982, 0.01)
pw[339:362,5] <- rnorm(24, 45.30812, 0.01)
pw[363:368,5] <- rnorm(6, 50.2, 0.01)
pw[369:374,5] <- rnorm(6, 43.99039, 0.01)

ph[1:252,6] <- rnorm(252, -578.8658, 0.01)
ph[253:290,6] <- rnorm(38, -440.8154, 0.01)
ph[291:338,6] <- rnorm(48, -609.7184, 0.01)
ph[339:362,6] <- rnorm(24, -511.1662, 0.01)
ph[363:368,6] <- rnorm(6, -472.1100, 0.01)
ph[369:374,6] <- rnorm(6, -453.4715, 0.01)
pw[1:252,6] <- rnorm(252, -578.8658, 0.01)
pw[253:290,6] <- rnorm(38, -440.8154, 0.01)
pw[291:338,6] <- rnorm(48, -609.7184, 0.01)
pw[339:362,6] <- rnorm(24, -511.1662, 0.01)
pw[363:368,6] <- rnorm(6, -472.1100, 0.01)
pw[369:374,6] <- rnorm(6, -453.4715, 0.01)

ph[1:252,7] <- rnorm(252, -5.3, 0.01)
ph[253:290,7] <- rnorm(38, 0.1, 0.01)
ph[291:338,7] <- rnorm(48, -8.6, 0.01)
ph[339:362,7] <- rnorm(24, -0.1, 0.01)
ph[363:368,7] <- rnorm(6, -2.3, 0.01)
ph[369:374,7] <- rnorm(6, 3.5, 0.01)
pw[1:252,7] <- rnorm(252, -5.3, 0.01)
pw[253:290,7] <- rnorm(38, 0.1, 0.01)
pw[291:338,7] <- rnorm(48, -8.6, 0.01)
pw[339:362,7] <- rnorm(24, -0.1, 0.01)
pw[363:368,7] <- rnorm(6, -2.3, 0.01)
pw[369:374,7] <- rnorm(6, 3.5, 0.01)

ph[1:252,8] <- rnorm(252, -26, 0.01)
ph[253:290,8] <- rnorm(38, -23.3, 0.01)
ph[291:338,8] <- rnorm(48, -27.9, 0.01)
ph[339:362,8] <- rnorm(24, -23.8, 0.01)
ph[363:368,8] <- rnorm(6, -25, 0.01)
ph[369:374,8] <- rnorm(6, -20.8, 0.01)
pw[1:252,8] <- rnorm(252, -26, 0.01)
pw[253:290,8] <- rnorm(38, -23.3, 0.01)
pw[291:338,8] <- rnorm(48, -27.9, 0.01)
pw[339:362,8] <- rnorm(24, -23.8, 0.01)
pw[363:368,8] <- rnorm(6, -25, 0.01)
pw[369:374,8] <- rnorm(6, -20.8, 0.01)

ph[1:252,9] <- rnorm(252, 3.05, 0.01)
ph[253:290,9] <- rnorm(38, 7.7166662, 0.01)
ph[291:338,9] <- rnorm(48, 0.1166666, 0.01)
ph[339:362,9] <- rnorm(24, 6.8166666, 0.01)
ph[363:368,9] <- rnorm(6, 6.5666666, 0.01)
ph[369:374,9] <- rnorm(6, 9.2333336, 0.01)
pw[1:252,9] <- rnorm(252, 3.05, 0.01)
pw[253:290,9] <- rnorm(38, 7.7166662, 0.01)
pw[291:338,9] <- rnorm(48, 0.1166666, 0.01)
pw[339:362,9] <- rnorm(24, 6.8166666, 0.01)
pw[363:368,9] <- rnorm(6, 6.5666666, 0.01)
pw[369:374,9] <- rnorm(6, 9.2333336, 0.01)

ph[1:252,10] <- rnorm(252, 1.883333, 0.01)
ph[253:290,10] <- rnorm(38, 7.7166662, 0.01)
ph[291:338,10] <- rnorm(48, -0.8833334, 0.01)
ph[339:362,10] <- rnorm(24, 6.8166666, 0.01)
ph[363:368,10] <- rnorm(6, 6.0499997, 0.01)
ph[369:374,10] <- rnorm(6, 9.2333336, 0.01)
pw[1:252,10] <- rnorm(252, 1.883333, 0.01)
pw[253:290,10] <- rnorm(38, 7.7166662, 0.01)
pw[291:338,10] <- rnorm(48, -0.8833334, 0.01)
pw[339:362,10] <- rnorm(24, 6.8166666, 0.01)
pw[363:368,10] <- rnorm(6, 6.0499997, 0.01)
pw[369:374,10] <- rnorm(6, 9.2333336, 0.01)

write.table(ph, '../phenotype_host_2.txt', row.names = F, col.names = F)
write.table(pw, '../phenotype_pathogen_2.txt', row.names = F, col.names = F)
