rm(list = ls());
setwd('/Users/han/data/SCU/lab/kuang_project/co_evolution/co_gwas')
wasp <- read.table('Plink_MAFFilter.vcf')
colnames(wasp) <- wasp[1,]
wasp <- wasp[-1,]
wasp <- wasp[,c(1:12,16,17,20,21,24,25,31,35,39,40,43,45,46,48,
                49:57,61:63,65,69:78,80:82,84,85,92,94,96,98,100:102,
                104:106,110,111,116,117,121,125:128,156,158,160,162,163,
                166,190:192)]
wasp[wasp == './.'] <- NA
wasp[wasp == '1/1'] <- NA
#wasp[wasp == '0/1'] <- NA
wasp <- na.omit(wasp)
wasp[,1] <- as.numeric(substr(wasp[,1], 5,5))
for (i in 10:82) {
  for (t in 1:nrow(wasp)) {
    if (wasp[t,i] == '0/0') {
      wasp[t,i] <- 0
    }
    else
      wasp[t,i] <- 1
  }
  print(i)
} # keep in single mutation

#for (i in 10:82) {
#  wasp[,i] <- as.numeric(substr(wasp[,i], 1,1))
#  print(i)
#}

wasp_1 <- wasp[,c(1,10:82)]
#wasp_1 <- wasp[,c(3,10:82)]
rm(wasp)
wasp_1$uni <- rep(0,nrow(wasp_1))
for (i in 1:nrow(wasp_1)) {
  wasp_1[i,75] <- length(unique(as.numeric(wasp_1[i,2:74])))
  print(i)
}
wasp_1 <- wasp_1[which(wasp_1$uni == 2),]
wasp_1$sec <- c(1:nrow(wasp_1))
w <- c(974,1091,1092,1099,1317,1671,1985,1986,2082,2083,2216,2218,2275,2374,2585,2661,2678,3287,3295,3349,3820,4083,4305,4668,5654,6058,6150,6371,6442,6476,6516,6533,6534,6572,6600,6809,6856,7250,7310,7327,7378,7379,7380,7403,7659,7717,7771,7886,8227,8252,8707,9397,9739,9832,10187,11064,11100,11140,11396,11811,11855,11902,12020,12148,12380,12423,12424,12575,12630,12698,12699,12700,12701,12715,12963,12964,12981,12991,13192,13685,13717,13788,13926,14734,14772,15111,15215,15373,15413,15511,16154,16162,16171,16652,16731,16755,16767,16891,17141,17335,17360,17371,17508,17595,17756,17897,17954,18127,18334,18378,18379,18380,18424,18541,18874,19601,19850,19863,20325,20327,20399,20638,20943,21002,21445,21639,21682,21690,21697,21810,21811,22229,22831,22973,23302,23339,23340,23542,23552,23598,23677,23733,23750,24047,25120,25121,25216,25361,25366,25471,25490,25930,26166,26219,26317,26760,26803,26879,26952,26977,27257,27421,27581,27620,28052,28091,29075,29607,29838,29852,29954,29955,29977,30226,30460,30577,30869,30953,31421,31594,32321,32347,32470,32472,32473,32702,32854,32928,33059,33213,33656,33761,33777,33783,33842,33964,33965,34016,34573,34922,34947,34955,34978,35295,35480,35579,35695,35912,35990,36961,37081,37146,37176,37184,37278,37659,37738,37881,37910,37954,37987,38000,38072,38092,38172,38189,38237,38367,38426,38717,38788,38831,38860,38892,38938,39078,39218,39651,39762,39806,39868,40087,40446,40565,40713,40789,40913,41753,41789,41809,41951,42278,42358,42468,42674,42756,42867,42904,43035,43063,43095,43135,43175,43516,43517,43572,43711,44013,44027,44090,44106,44163,44882,44894,45077,45080,45241,45328,45329,45330,45331,45375,45376,45776,45842,46117,46127,46218,46299,46322,46394,46584,46610,46646,46985,47038,47209,47210,47231,47241,47398,47415,47512,47549,47613,47614,47780,47806,47904,48057,48110,48293,48308,48434,48830,48940,48963,49401,49407,49620,49621,49658,49685,50600,50742,50821,51047,51108,51460,51649,51668,51786,51842,51843,51908,51912,51913,52045,52189,52375,52446,52892,53005,53107,53187,53226,53366,53401,53645,53646,53682,53844,54280,54281,54550,54781,54897,55256,55412,55872,55887,55902,56041,56133,56261,56644,58807,58903,58916,58933,58995,58996,59129,59304,59660,59681,59697,59698,59838,59878,59948,60029,60061,60093,60269,60483,60497,60571,60880,61001,61095,61422,61499,62444,62445,62946,63060,63062,63065,63067,63104,63208,63232,63280,63788,63996,64064,64214,64324,64876,64954,65086,65113,65492,65513,65672,65696,65903,66066)

write.table(wasp_1[which(wasp_1$sec %in% w),], 'wasp_position.txt', quote = F, row.names = F)
write.table(wasp_1[,c(1,76,2:74)], 'seq_wasp.txt', quote = F, row.names = F, col.names = F)

#####################
# host 
rm(list = ls());
setwd('/Users/han/data/SCU/lab/kuang_project/co_evolution/co_gwas')
#host <- read.vcfR('MD_maf0.05.miss0.8.LD.vcf')
#my.vcf.df <- cbind(as.data.frame(getFIX(host)), INFO2df(host))

host <- read.table('matlab.vcf')
host[host == './.'] <- NA
host[host == '1/1'] <- NA
#host[host == '0/1'] <- NA
host <- na.omit(host)
host[,1] <- as.numeric(host[,1])
write.table(host, 'test.txt', row.names = F, col.names = F)
host <- read.table('test.txt')

#for (i in 10:32) {
  host[which(host[,i] == '0'),i] <- 0
  print(i)
}

#for (i in 10:32) {
#  host[,i] <- as.numeric(substr(host[,i], 1,1))
#  print(i)
#}
#host_1 <- host[,c(1,10:32)]
host_1 <- host[,c(3,10:32)]
rm(host)
host_1$uni <- rep(0,nrow(host_1))

fun <- function(x,output){
  x[25] <- (length(unique(unlist(x[2:24]))))
}
ve <- apply(host_1,1,fun)
host_1[,25] <- ve

host_1 <- host_1[which(host_1$uni == 2),]
host_1$sec <- c(1:nrow(host_1))

#h <- c(16172,23753,38999,41203,48544,60077,61835,67439,68255,71794,75508,84427,85469,86317,89455,101317,114996,115709,129723,131383,136177,137623,144741,159084,182551,183021,197900,201272,213394,239180,252935,263978,273753,284499,292479,304016,307942,320133,322875,329409,356778,358570,368784,388375,423908,428912,440895,441400,441510,484069,489857,496449,502898,515426,539210,539212,539263,542041,542800,560028,566406,572508,574018,612451,622277,626329,643919,643953,643971,643977,643979,643980,643999,644003,644018,645008,645567,666702,670387,681616,696360,699938,703965,704205,708464,714359,714392,718580,723813,727533,735864,738039,738078,749758,750438,750543,754595,758578,759392,763585,763586,764394,764445,765258,766332,770268,779577,787539,798399,805184,808093,809006,809800,817849,819105,828742,833236,841934,854360,858956,868769,876536,919161,920804,966380,975696,978579,981123,981441,985814,1025489,1025536,1050077,1054197,1063040,1066355,1070053,1090897,1102021,1116547,1118115,1166443,1219521,1230023,1230052,1230058,1230116,1230263,1233431,1233762,1234118,1234145,1234399,1234508,1234560,1234679,1234969,1235053,1235062,1235082,1235468,1235476,1235692,1235765,1235786,1235869,1236023,1236775,1237117,1237223,1237233,1237271,1237320,1237415,1237423,1237516,1237549,1237553,1237558,1237647,1237732,1237780,1238833,1254901,1269531,1270871,1270875,1270877,1270896,1270908,1270912,1270922,1270926,1270933,1270944,1270952,1270957,1272305,1284138,1287269,1291854,1292333,1308113,1320623,1326914,1353988,1370040,1377914,1383631,1412378,1430387,1433154,1454751,1466547,1483476,1483953,1485934,1491598,1500892,1506314,1514289,1551251,1559623,1570775,1598138,1603251,1610520,1628692,1629485,1630737,1637668,1640509,1641713,1659407,1659485,1660020,1668734,1674316,1676097,1690686,1692563,1698448,1698449,1698461,1698474,1698487,1698490,1698500,1698515,1698589,1698593,1698630,1698636,1698639,1698647,1698657,1698701,1698708,1698736,1698746,1698751,1698778,1698794,1698808,1698915,1698957,1699035,1699042,1699063,1699085,1699090,1699098,1699102,1699105,1718299,1720123,1721145,1722934,1728506,1728522,1761337,1763686,1781529,1792882,1793921,1794648,1796196,1803342,1823901,1853384,1859619,1890091,1897334,1904622,1907809,1922316,1945572,1959184,2011904,2015087,2029856,2035641,2035940,2036270,2049209,2049745,2059051,2070615,2073107,2089407,2098408,2098412,2099958,2101222,2101343,2101376,2104387,2107286,2112462,2130035,2141404,2149292,2167913,2172441,2185214,2201072,2206488,2208128,2208219,2208456,2209651,2210155,2226161,2229180,2244354,2254097,2259041,2271624,2275471,2288722,2321558,2323751,2324319,2336381,2340230,2349857,2363057,2367222,2367791,2367825,2368353,2387232,2398598,2400783,2401039,2411153,2435756,2441820,2477784,2483806,2522337,2527931,2531571,2531759,2532057,2532163,2533634,2535118,2537900,2545584,2569096,2574792,2577131,2600428,2609971,2611085,2612397,2613755,2617833,2618454,2619077,2620093,2622223,2624284,2627135,2628533,2632630,2635305,2636007,2639016,2644249,2658454,2667403,2680164,2686723,2722541,2726529,2732401,2734167,2737786,2761349,2798795,2824114,2831209,2833908,2843903,2856198,2897412,2900688,2911592,2926738,2937760,2969779,2978550,2987211,2996965,3014849,3031164,3031316,3034114,3054001,3065493,3079267,3084027,3092658,3130276,3138532,3144036,3161788,3167016,3171717,3173383,3221823,3267788,3301155,3329244,3371176,3387538,3394919,3416593,3455163,3458468,3459734,3462306,3467067,3470085,3481206,3490813,3495740,3496371,3498278,3518000,3551758,3553629,3555934,3556146,3559117,3564425,3608001,3611314,3639239,3644809,3648322,3654842,3657288,3657580,3657586,3657610,3657657,3657660,3657689,3657765,3657769,3657771,3657780,3657783,3657798,3657819,3657823,3657858,3657903,3657924,3659165,3685725,3686124,3691770,3695483,3701592,3703195,3707222,3711802,3721058,3729144,3735709,3737279,3746715,3747647,3747803,3758566,3772765,3774834,3779730,3788621,3788805,3791944,3796963,3823147,3830823,3831025,3848674,3871502,3875956,3884365,3890573,3891411,3894238,3905737,3912437,3943182,3943489,3946561,3954642,3962595,3975159,3993279,4004482,4008231,4008887,4008963,4009088,4010270,4010326,4010340,4010343,4010388,4010402,4010410,4010449,4010454,4010580,4010625,4010653,4010742,4010749,4011261,4011417,4011968,4012321,4013159,4013348,4013679,4013697,4014400,4087464,4093063,4098007,4098801,4099070,4115152,4118554,4119654,4122716,4134240,4136804,4148696,4152625,4159123,4165970,4170907,4170911,4181473,4181839,4220705,4234979,4238676,4258307,4260708,4266087,4277459,4282802,4295487,4302671,4312755,4314136,4346099,4346437,4358656,4360695,4360711,4360923,4362051,4363683,4367058,4368039,4368057,4371344,4374560,4377366,4377961,4381291,4390823,4446903,4447342,4447369,4447477,4462944,4475145,4475824,4476235,4480094,4487117,4487485,4509478,4510278,4529510,4531109,4534510,4558388,4566753,4589550,4610240,4614946,4620032,4620136,4640269,4645016,4650155,4650907,4656742,4666870,4678656,4680028,4684015,4701130,4755976,4756015,4774414,4774415,4774428,4774480,4774487,4774497,4774599,4774605,4774607,4780279,4818846,4831170,4840216,4840719,4849903,4850876,4852149,4862475,4915620,4921328,4925858,4929164,4973299,4979736,5012458,5021799,5026045,5026129,5032128,5034822,5035001,5039098,5051423,5061710,5064807,5066580,5067638,5074077,5081204,5083135,5084483,5089555,5090849,5091789,5101094,5140823,5156203,5182799,5190615,5193877,5194144,5207669,5231427,5232263,5232421,5232430,5232589,5234845,5247922,5270832,5279390,5300719,5302336,5316707,5355114,5363965,5366728,5382127,5400494,5439042,5451476,5456568,5458632,5469178,5491093,5502364,5513141,5514036,5521499,5553701,5554967,5558030,5572781,5574997,5604248,5611020,5627632,5643505,5652512,5653653,5655053,5669944,5693449,5697878,5698253,5702334,5708425,5712377,5741470,5742934,5749367,5753334,5755699,5762431,5764418,5767190,5777084,5786085,5786854,5790966,5801087,5805298,5817980,5828382,5836100,5849785,5850272,5863383,5872111,5881601,5890967,5902738,5905937,5917384,5919060,5919674,5931561,5935157,5939051,5943857,5951768,5988683,6000837,6001591,6004344,6053531,6066063,6067456,6090322,6112411,6122691,6131938,6133404,6145083,6155955,6171201,6181385,6220472,6222989,6234565,6234657,6234870,6246371,6258750,6267632,6279456,6296891,6320187,6320877,6322638,6332092,6335787,6340850,6343783,6350481,6353076,6353253,6353254,6357483,6358267,6360639,6363848,6363908,6363926,6363953,6363979,6363986,6364001,6364003,6364029,6364031,6364064,6364084,6372205,6374657,6381073,6390895,6395530,6398877,6404459,6404855,6406396,6407497,6408061,6411643,6414588,6415564,6419555,6446213,6469811,6492733,6502770,6515448,6516906,6527268,6547290,6549367,6560567,6562905,6585711,6596123,6596634,6600026,6627687,6627936,6627948,6627958,6627995,6628011,6628024,6628255,6628373,6637884,6640355,6643112,6644833,6654816,6677335,6686063,6686968,6687769,6687815,6688041,6688065,6692919,6693828,6696396,6697609,6700666,6705652,6710566,6724730,6727329,6733202,6736359,6737493,6751569,6760159,6771466,6779511,6783940,6797893,6799508,6811557,6813742,6826122,6834276,6837848,6845998,6848189,6852788,6855638,6866087,6869716,6889181,6911998,6923674,6933792,6941673,6977888,7001594,7019479,7021149,7035576,7072373,7088304,7089519,7094752,7096659,7116034,7127205,7162488,7178516,7194900,7222730,7226633,7231120,7240892,7252984,7257057,7261842,7282870,7308719,7311550,7324206,7340902,7344560,7350386,7351520,7354875,7358318,7403544,7419332,7425186,7446170,7465310,7481796,7492911,7494056,7496500,7502448,7504245,7517894,7531142,7568114,7570186,7572030,7573896,7580014,7584126,7593475,7596111,7602430,7608839,7611460,7624052,7631292,7664096,7676663,7690044,7716746,7717425,7756086,7758243,7762862,7835066,7836368,7840876,7866764,7872499,7878308,7931615,7973358,7977395,7981587,7987608,7990175,7996469,8007893,8044689,8063685,8070906,8075581,8076871,8079413,8117068,8123302,8140074,8166873,8171142,
#       8200186,8200979,8236021,8244579,8257086,8306328,8310453,8316722,8327065,8331318,8345127,8351912,8364992,8381310,8405554,8411004,8412670,8418290,8418705,8428605,8434517,8452725,8461415,8463977,8473093,8481803,8485455,8509414,8515880,8519930,8520123)
write.table(host_1[which(host_1$sec %in% h),], 'host_position.txt', quote = F, row.names = F)

write.table(host_1[,c(1,26,2:24)], 'seq_host.txt', quote = F, row.names = F, col.names = F)
